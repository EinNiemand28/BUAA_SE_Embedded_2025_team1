

### 书籍表

| 属性名           | 中文名称         | 数据类型    | 备注                       |
| ---------------- | ---------------- | ----------- | -------------------------- |
| id               | 书籍ID           | INT         | 主键，自增                 |
| isbn             | 国际标准图书编号 | VARCHAR(25) |                            |
| title            | 书名             | VARCHAR(25) |                            |
| author           | 作者             | VARCHAR(25) |                            |
| publisher        | 出版社           | VARCHAR(35) |                            |
| publication_year | 出版年份         | YEAR        |                            |
| status           | 书籍状态         | ENUM        | 如“在架”、“借出”、“异常”等 |
| current_slot_id  | 实在插槽ID       | INT         | 外键，关联插槽表           |
| intended_slot_id | 应在插槽ID       | INT         | 外键，关联插槽表           |
| created_at       | 创建时间         | TIMESTAMP   | 默认当前时间               |
| updated_at       | 更新时间         | TIMESTAMP   | 每次修改记录自动更新       |



### 书架插槽表

| 属性名       | 中文名称     | 数据类型  | 备注                  |
| ------------ | ------------ | --------- | --------------------- |
| id           | 书架插槽ID   | INT       | 主键，自增            |
| row          | 水平位置索引 | INT       | 从低到高              |
| level        | 垂直高度索引 | INT       | 从左到右              |
| relative_x   | X偏移        | INT       | 相对于书架中心的X偏移 |
| relative_y   | Y偏移        | INT       | 相对于书架中心的Y偏移 |
| relative_z   | 高度         | INT       | 相对于地面            |
| bookshelf_id | 所在书架ID   | INT       | 外键，关联书架表      |
| is_occupied  | 占用标识     | BOOLEAN   | 标记插槽是否可用      |
| created_at   | 创建时间     | TIMESTAMP | 默认当前时间          |
| updated_at   | 更新时间     | TIMESTAMP | 每次修改记录自动更新  |



### 书架表

| 属性名             | 中文名称         | 数据类型    | 备注                                  |
| ------------------ | ---------------- | ----------- | ------------------------------------- |
| id                 | 书架ID           | INT         | 主键，自增                            |
| code               | 书架编码         | VARCHAR(10) | 如 "A1"                               |
| name               | 描述性名称       | VARCHAR(20) |                                       |
| center_x           | X坐标            | DOUBLE      | 书架中心X坐标                         |
| center_y           | Y坐标            | DOUBLE      | 书架中心Y坐标                         |
| orientation        | 书架开口朝向角度 | DOUBLE      | (单位：弧度，0表示正东，pi/2表示正北) |
| length             | 书架长度         | DOUBLE      |                                       |
| width              | 书架宽度         | DOUBLE      |                                       |
| height             | 书架高度         | DOUBLE      |                                       |
| levels             | 书架层数         | INT         |                                       |
| slots_per_level    | 每层的插槽数量   | INT         |                                       |
| bottom_clearance   | 最底层距地面高度 | DOUBLE      |                                       |
| level_height       | 每层高度         | DOUBLE      |                                       |
| is_transit_station | 中转站标记       | BOOLEAN     | 标记书架是否为中转站                  |
| created_at         | 创建时间         | TIMESTAMP   | 默认当前时间                          |
| updated_at         | 更新时间         | TIMESTAMP   | 每次修改记录自动更新                  |



### 用户表

| 属性名          | 中文名称 | 数据类型     | 备注                 |
| --------------- | -------- | ------------ | -------------------- |
| id              | 用户ID   | INT          | 主键，自增           |
| email           | 电子邮箱 | VARCHAR(50)  | 不可为空             |
| username        | 用户名   | VARCHAR(50)  | 不可为空             |
| password_digest | 密码     | VARCHAR(255) | 加密后的密码         |
| role            | 用户权限 | INT          | admin/user等         |
| created_at      | 创建时间 | TIMESTAMP    | 默认当前时间         |
| updated_at      | 更新时间 | TIMESTAMP    | 每次修改记录自动更新 |



### 会话表

| 属性名     | 中文名称   | 数据类型     | 备注                         |
| ---------- | ---------- | ------------ | ---------------------------- |
| id         | 会话ID     | INT          | 主键，自增                   |
| user_id    | 用户ID     | INT          | 外键，关联用户               |
| agent      | 用户代理   | VARCHAR(255) | 用户的浏览器或客户端标识信息 |
| ip_address | 登录IP地址 | VARCHAR(255) | 用户访问时的网络地址         |
| created_at | 注册时间   | TIMESTAMP    | 默认当前时间                 |
| updated_at | 更新时间   | TIMESTAMP    | 每次修改记录自动更新         |



### 地图表（Maps）

| 属性名             | 中文名称     | 数据类型     | 备注                                                      |
| ------------------ | ------------ | ------------ | --------------------------------------------------------- |
| id                 | 地图ID       | INT          | 主键，自增                                                |
| name               | 地图名称     | VARCHAR(50)  | 用户自定义名称，如"一层北区 - 2024-07-29"                 |
| map_data_url       | 地图数据路径 | VARCHAR(255) | 指向 ROS 地图文件 (如 .pgm 和 .yaml) 或其他格式的存储位置 |
| created_by_user_id | 创建用户ID   | INT          | 外键，关联Users表（通常是管理员）                         |
| description        | 描述         | TEXT         | 可选，地图备注信息                                        |
| created_at         | 注册时间     | TIMESTAMP    | 默认当前时间                                              |
| updated_at         | 更新时间     | TIMESTAMP    | 每次修改记录自动更新                                      |



### 任务表 (tasks)

| 属性名               | 中文名称     | 数据类型  | 备注                                                       |
| -------------------- | ------------ | --------- | ---------------------------------------------------------- |
| id                   | 任务ID       | INT       | 主键，自增                                                 |
| type                 | 任务类型     | ENUM      | MAP_BUILD_AUTO', 'NAVIGATION_TO_POINT', 'SYSTEM_COMMAND'等 |
| status               | 任务状态     | ENUM      | 'pending', 'processing', 'completed', 'failed'等           |
| priority             | 优先级       | INT       | 数字越大优先级越高                                         |
| book_id              | 书籍ID       | INT       | 外键，关联对应的书籍（可为空）                             |
| source_slot_id       | 来源插槽ID   | INT       | 外键，关联对应的书架插槽（可为空）                         |
| target_slot_id       | 目标插槽ID   | INT       | 外键，关联对应的书架插槽（可为空）                         |
| target_point_x       | 目标点X坐标  | DOUBLE    | 用于 NAVIGATION_TO_POINT 任务，或精确指定操作点（可为空）  |
| target_point_y       | 目标点Y坐标  | DOUBLE    | 用于 NAVIGATION_TO_POINT 任务，或精确指定操作点（可为空）  |
| target_point_z       | 目标点Z坐标  | DOUBLE    | 用于 NAVIGATION_TO_POINT 任务，或精确指定操作点（可为空）  |
| target_orientation_z | 目标点朝向   | DOUBLE    | 用于 NAVIGATION_TO_POINT 任务，或精确指定操作点（可为空）  |
| user_id              | 创建用户ID   | INT       | 外键，关联任务的创建用户                                   |
| parent_task_id       | 父任务ID     | INT       | 外键，自关联Tasks表，用于分解复杂任务（可为空）            |
| scheduled_at         | 计划执行时间 | DATETIME  | 任务计划开始的时间                                         |
| started_at           | 实际开始时间 | DATETIME  | 任务实际开始的时间                                         |
| completed_at         | 完成时间     | DATETIME  | 任务完成的时间                                             |
| progress_details     | 进度信息     | JSON      | 结构化的任务信息                                           |
| result_data          | 结果数据     | JSON      | 结构化的任务结果数据                                       |
| created_at           | 创建时间     | TIMESTAMP | 默认当前时间                                               |
| updated_at           | 更新时间     | TIMESTAMP | 每次修改记录自动更新                                       |



### 系统日志表 (system_logs)
| 属性名         | 中文名称     | 数据类型     | 备注                                  |
| -------------- | ------------ | ------------ | ------------------------------------- |
| id             | 日志ID       | INT          | 主键，自增                            |
| type       | 日志类型     | ENUM         | 'system', 'robot', 'user', 'task', 'error' |
| severity       | 严重程度     | ENUM         | 'info', 'warning', 'error', 'critical' |
| message        | 日志消息     | TEXT         | 日志详细内容                          |
| source         | 日志来源     | VARCHAR(50)  | 产生日志的系统组件                    |
| user_id        | 用户ID       | INT          | 外键，关联相关用户（可为空）          |
| task_id        | 任务ID       | INT          | 外键，关联相关任务（可为空）          |
| book_id        | 书籍ID       | INT          | 外键，关联相关书籍（可为空）          |
| created_at     | 创建时间     | TIMESTAMP    | 日志产生时间                          |



### 机器人状态表 (robot_status) 

| 属性名        | 中文名称   | 数据类型  | 备注                                    |
| ------------- | ---------- | --------- | --------------------------------------- |
| id            | 状态记录ID | INT       | 主键，自增                              |
| status        | 机器人状态 | ENUM      | 'idle', 'moving', 'grabbing', 'error'等 |
| error_message | 错误信息   | TEXT      | 机器人错误状态描述（可为空）            |
| created_at    | 创建时间   | TIMESTAMP | 默认当前时间                            |
| updated_at    | 更新时间   | TIMESTAMP | 每次修改记录自动更新                    |
