# 1、需求对接

## 1.1 功能需求

*   书籍检索与导航


*   机械臂抓取与物品识别


*   地图构建（自动 / 手动模式）


*   用户交互界面（前端指令与状态反馈）


## 1.2 业务需求

*   核心流程：检索→导航→抓取→归还


*   多任务调度：优先级处理（如急停指令中断导航）


*   数据管理：数据库 CRUD 操作（书籍、用户、任务等）


## 1.3 异常处理需求

*   导航障碍物检测与避障


*   机械臂抓取失败重试机制


*   系统权限控制（普通用户 vs 管理员）

# 二、单元测试

## 2.1 测试概况

*   **测试阶段**：模块级功能验证（白盒 + 黑盒测试）


*   **测试范围**：ROS 节点、前端 UI、机械臂控制、算法单元、数据库


*   **核心数据**：


| 测试类别&#xA;   | 总用例数&#xA; | 通过数&#xA; | 通过率&#xA; | 主要问题模块&#xA;       |
| --------------- | ------------- | ----------- | ----------- | ----------------------- |
| ROS 端服务&#xA; | 30&#xA;       | 28&#xA;     | 93.3%&#xA;  | 导航模块、建图模块&#xA; |
| 前端 UI&#xA;    | 25&#xA;       | 22&#xA;     | 88.0%&#xA;  | 数据显示、指令交互&#xA; |
| 机械臂控制&#xA; | 15&#xA;       | 13&#xA;     | 86.7%&#xA;  | 运动精度、硬件驱动&#xA; |
| 算法单元&#xA;   | 5&#xA;        | 5&#xA;      | 100%&#xA;   | 路径规划、书籍识别&#xA; |
| 数据库&#xA;     | 5&#xA;        | 5&#xA;      | 100%&#xA;   | CRUD 操作&#xA;          |

## 2.2 核心测试项示例

| 测试项&#xA;         | 测试对象&#xA;                  | 验证点&#xA;                        | 测试结果&#xA;                            |
| ------------------- | ------------------------------ | ---------------------------------- | ---------------------------------------- |
| 建图服务测试&#xA;   | /mapping/start Service&#xA;    | 服务响应、节点启动、地图发布&#xA;  | 成功启动自动建图，/map 话题正常输出&#xA; |
| 导航控制测试&#xA;   | /navigation/abort Service&#xA; | 急停响应时间、任务中断机制&#xA;    | 接收到指令后 0.5 秒内停止移动&#xA;       |
| 机械臂抓取测试&#xA; | /arm\_control Service&#xA;     | 目标定位精度、抓取动作完整性&#xA;  | 误差≤5cm，抓取成功率 95%&#xA;            |
| 书籍识别测试&#xA;   | vision\_identify 算法&#xA;     | ISBN 识别准确率、空间定位精度&#xA; | 标准光照下准确率 100%，位置误差≤3cm&#xA; |

## 2.3 典型问题与解决方案

### 案例 1：ROS 端逻辑错误

*   **问题**：导航模块无地图数据时未返回错误


*   **影响**：系统崩溃风险


*   **方案**：增加空数据校验逻辑，返回 HTTP 400 错误码


### 案例 2：前端 UI 接口错误

*   **问题**：/task\_progress 话题数据格式不匹配


*   **影响**：进度条显示异常


*   **方案**：统一前后端数据协议，增加格式校验中间件


### 案例 3：机械臂硬件偏差

*   **问题**：高速运动时关节角度误差超 10°


*   **影响**：抓取失败率升高


*   **方案**：优化 PID 控制参数，增加运动平滑滤波算法


## 2.4 测试工具与环境

*   **工具**：Google Test（C++ 单元测试）、PyTest（Python 脚本测试）、Rviz（可视化验证）


*   **环境**：

    *   虚拟仿真：Gazebo+Ubuntu 20.04+ROS Noetic


    *   实物测试：机器人原型机 + 激光雷达 + 机械臂




# 三、集成测试用例

## 3.1 测试概况

*   **测试项**：5 项（ROS 接口集成、前后端通信、模块交互等）


*   **用例数**：30 个（黑盒测试为主）


*   **通过率**：93.3%（28/30）


## 3.2 核心测试项

| 测试项&#xA;       | 用例数&#xA; | 测试功能&#xA;           | 关键验证点&#xA;            |
| -------------- | -------- | ------------------- | --------------------- |
| ROS 接口集成&#xA;  | 5&#xA;   | 导航 + 机械臂控制&#xA;     | 目标位置传递、动作协同性&#xA;     |
| 前后端通信&#xA;     | 3&#xA;   | Rails+ROS 数据交互&#xA; | 指令传输延迟、状态实时更新&#xA;    |
| 感知 - 决策模块&#xA; | 4&#xA;   | 激光雷达→路径规划&#xA;      | 障碍物识别率、路径重规划耗时&#xA;   |
| 多任务调度&#xA;     | 2&#xA;   | 导航 + 急停指令&#xA;      | 任务中断响应时间、日志记录完整性&#xA; |
| 数据库集成&#xA;     | 3&#xA;   | CRUD 操作&#xA;        | 数据一致性、并发访问稳定性&#xA;    |



## 3.3 典型问题案例

### 案例 1：导航 - 机械臂坐标系错误

*   **现象**：导航模块传递的目标位置与机械臂实际抓取位置偏差 10cm


*   **影响**：抓取失败率达 30%


*   **解决方案**：统一坐标系转换算法，增加校准接口


### 案例 2：前端界面卡顿

*   **现象**：连续发送导航指令时，界面延迟超 2 秒


*   **影响**：用户体验差


*   **解决方案**：优化 Action Cable 消息队列，引入异步处理机制

# 四、系统测试用例

## 4.1 测试概况

*   **测试项**：4 项（功能、性能、安全、稳定性）


*   **用例数**：27 个


*   **通过率**：92.6%（25/27）


## 4.2 核心测试场景

| 测试项&#xA;   | 用例数&#xA; | 测试场景&#xA;          | 关键指标&#xA;                     |
| ---------- | -------- | ------------------ | ----------------------------- |
| 端到端功能&#xA; | 15&#xA;  | 书籍检索→导航→抓取全流程&#xA; | 完成时间≤5 分钟、成功率≥95%&#xA;        |
| 性能稳定性&#xA; | 4&#xA;   | 8 小时连续巡检&#xA;      | CPU 占用≤70%、内存泄漏≤50MB&#xA;     |
| 异常处理&#xA;  | 3&#xA;   | 导航中障碍物阻挡&#xA;      | 避障响应时间≤2 秒、路径重规划成功率 100%&#xA; |
| 安全性&#xA;   | 3&#xA;   | 用户权限验证&#xA;        | 管理员功能拦截率 100%、数据加密传输&#xA;     |

# 五、测试结果分析与改进

## 5.1 问题分类统计

| 错误类型&#xA; | 集成测试&#xA; | 系统测试&#xA; | 占比&#xA;    |
| --------- | --------- | --------- | ---------- |
| 接口交互&#xA; | 2&#xA;    | 1&#xA;    | 37.5%&#xA; |
| 业务逻辑&#xA; | 1&#xA;    | 1&#xA;    | 25%&#xA;   |
| 硬件协同&#xA; | 1&#xA;    | 0&#xA;    | 12.5%&#xA; |
| 性能瓶颈&#xA; | 0&#xA;    | 1&#xA;    | 12.5%&#xA; |
| 其他&#xA;   | 0&#xA;    | 1&#xA;    | 12.5%&#xA; |

## 5.2 改进建议

1.  **接口标准化**：制定模块间数据交互规范


2.  **自动化测试**：引入 Jenkins 持续集成测试


3.  **硬件调优**：机械臂运动参数精细化校准


4.  **压力测试**：模拟 100 用户并发检索场景
